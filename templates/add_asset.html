<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>자산 추가 - J&D 하우스 관리</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 sm:p-8 flex justify-center items-center">
    <div class="max-w-xl w-full bg-white p-6 sm:p-8 rounded-2xl shadow-xl">
        <h1 class="text-2xl sm:text-3xl font-bold text-gray-800 text-center mb-6 flex items-center justify-center">
            <i class="fa-solid fa-plus-circle text-indigo-600 mr-2"></i> 자산 추가
        </h1>
        <form action="/add_asset" method="post" class="space-y-6">
            <div>
                <label for="date" class="block text-sm font-medium text-gray-700">날짜</label>
                <input type="date" id="date" name="date" value="{{ today }}" required
                       class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-full shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
            </div>
            <div>
                <label for="category" class="block text-sm font-medium text-gray-700">카테고리</label>
                <select id="category" name="category" required
                        class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-full shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                    <option value="" disabled selected>카테고리 선택</option>
                    <option value="현금">현금</option>
                    <option value="예금">예금</option>
                    <option value="예금">적금</option>
                    <option value="주식">주식</option>
                    <option value="청약">청약</option>
                    <option value="부동산">부동산</option>
                    <option value="자동차">자동차</option>
                    <option value="대출">대출</option>
                    <option value="기타">기타</option>
                </select>
            </div>
            <div>
                <label for="item" class="block text-sm font-medium text-gray-700">항목</label>
                <input type="text" id="item" name="item" required
                       class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-full shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
            </div>
            <div>
                <label for="amount" class="block text-sm font-medium text-gray-700">금액</label>
                <div class="mt-1 flex space-x-2">
                    <input type="number" id="amount" name="amount" step="0.01" required
                           class="w-1/2 px-4 py-2 border border-gray-300 rounded-full shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                    <div id="korean-amount" class="w-1/2 px-4 py-2 border border-gray-300 rounded-full bg-gray-50 text-gray-500 sm:text-sm flex items-center overflow-hidden whitespace-nowrap">
                    </div>
                </div>
            </div>
            <div>
                <label for="notes" class="block text-sm font-medium text-gray-700">메모</label>
                <textarea id="notes" name="notes" rows="3"
                          class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-xl shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"></textarea>
            </div>
            <div class="flex justify-between items-center space-x-4">
                <a href="/" class="flex-1 text-center bg-gray-300 text-gray-800 py-2 px-4 rounded-full font-semibold hover:bg-gray-400 transition duration-300 ease-in-out">
                    취소
                </a>
                <button type="submit" class="flex-1 bg-indigo-600 text-white py-2 px-4 rounded-full font-semibold hover:bg-indigo-700 transition duration-300 ease-in-out">
                    <i class="fa-solid fa-save mr-1"></i> 저장
                </button>
            </div>
        </form>
    </div>

    <script>
        function convertToKorean(num) {
            if (num === 0) return '영';
            
            const numStr = String(Math.floor(num));
            const units = ['', '만', '억', '조', '경', '해'];
            const digits = ['', '일', '이', '삼', '사', '오', '육', '칠', '팔', '구'];
            const tenUnits = ['', '십', '백', '천'];
            
            let result = '';
            let unitIndex = 0;
            
            let tempNumStr = numStr;
            while (tempNumStr.length > 0) {
                const chunk = tempNumStr.slice(-4);
                const chunkNum = parseInt(chunk);
                let chunkResult = '';
                
                if (chunkNum === 0) {
                    tempNumStr = tempNumStr.slice(0, -4);
                    unitIndex++;
                    continue;
                }

                for (let i = 0; i < chunk.length; i++) {
                    const digit = parseInt(chunk[i]);
                    const digitIndex = chunk.length - 1 - i;
                    if (digit !== 0) {
                        if (digit === 1 && tenUnits[digitIndex] !== '') {
                             chunkResult += tenUnits[digitIndex];
                        } else {
                            chunkResult += digits[digit] + tenUnits[digitIndex];
                        }
                    } 
                }
                
                chunkResult = chunkResult.trim();
                if (chunkResult !== '') {
                    result = chunkResult + units[unitIndex] + ' ' + result;
                }
                
                tempNumStr = tempNumStr.slice(0, -4);
                unitIndex++;
            }
            
            return result.trim().replace(/\s+/g, ' ');
        }
        
        const amountInput = document.getElementById('amount');
        const koreanAmountDiv = document.getElementById('korean-amount');

        amountInput.addEventListener('input', () => {
            const amount = parseFloat(amountInput.value);
            if (!isNaN(amount) && amount >= 0) {
                const koreanText = convertToKorean(amount) + '원';
                koreanAmountDiv.textContent = koreanText;
            } else {
                koreanAmountDiv.textContent = '';
            }
        });
    </script>
</body>
</html>
